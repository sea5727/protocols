# 아키텍쳐

# Introduction


자주 사용되는 MediaServer 아키텍쳐는 Mesh, SFU, MCU 3개가 있다. 

WebRTC에서 일반적으로 사용되는 방식은 SFU이다   
VoIP 에서 일반적으로 사용되는 방식은 MCU이다.   
1:1 통화에서 일반적으로 사용디는 방식은 P2P(Mesh??)이다.  


# Mesh(P2P)
단말과 단말이 직접 통신하는 방법이다.   
시그널링을 단말 간에 진행할 수도 있고, 서버를 경유하여 진행 할 수 있으나, 미디어 스트림은 서버를 경유하지 않고 단말간 통신을 하는게 일반적이다. 가장 구현이 간단하며 Cost (서버 비용) 가 적다. 하지만 Network Bandwidth는 Conference인경우 참여자가 늘어 날 수록 n(n-1)/2 만큼 
늘어난다. 또한, 단말의경우 Uplink의 Bandwidth가 증가하므로 단말의 비용이 가장 높은 방식이다.
1:1 또는 소규모 미디어 교환에 적합하다.

# SFU
Mesh방식과 다르게 서버를 두고 경유하는 방식이다. 일반적으로 인코딩/디코딩을 하지 않고 전달하는 방식을 취한다.
1:N 스트리밍 서비스에 적합하다.
Conference 인경우 네트워크 트래픽 규모는 n^2 Mesh보다 증가한다. 하지만 단말은 1개의 Unlink만 사용하면 되므로 단말의 코스트는 Mesh보다 줄어든다. 하지만 서버의 비용은 증가하게된다.
Large-Scale Conference 인 경우 단말이 처리할 수 있는 threshold ( bandwidth, port, 참여자수 )를 초과하는경우 정상적인 처리가 불가능하다

# MCU
MCU방식은 단말들의 미디어를 서버에서 디코딩, 믹싱, 인코딩 하여 단말들로 내려주는 방식이다. 따라서 서버에서의 CPU/GPU 부하가 발생하며, 실시간성이 보장받기 어렵다.
단말들의 코덱 지원에 맞춰줄수 있고, 단말과 서버간 스트림이 1개만 존재하여 단말의 Bandwidth가 줄어든다. 또한 단말의 코덱환경을 서버에서 맞춰줄수 있다. 
Large-Scale의 Conference 에 적합할 수 있다.
